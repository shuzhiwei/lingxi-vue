webpackJsonp([16],{"1X4W":function(e,t){},tfHa:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("g5nd"),a=n("miE6"),i=n("mtWM"),r=n.n(i),s=n("mw3O"),l=n.n(s),c={inject:["reload"],data:function(){return{token:Object(o.b)("lingxi-token"),username:Object(o.b)("username"),title:"",content:"",imageAddr:"",image:"",imageAddrs:[],delImageAddrs:[],defaultImg:'this.src="'+n("DBQu")+'"',dialogImageUrl:"",dialogVisible:!1,fileList:[],form:{images1:[],radio:0}}},methods:{deleteCurPhoto:function(e){this.delImageAddrs.push(this.imageAddrs[e]),this.imageAddrs.splice(e,1)},deletePrePhoto:function(e){this.form.images1.splice(e,1)},openFile:function(){document.getElementById("filename").click()},showRealPath:function(){for(var e=this,t=document.getElementById("filename").files,n=function(n){var o=t[n].name,a=new FileReader;a.readAsDataURL(t[n]),a.onload=function(){var t=a.result;e.form.images1.push({name:o,image:t})}},o=0;o<t.length;o++)n(o)},postCancel:function(){this.$router.push({path:"/main/home"})},selectFile:function(){var e=this,t=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),n=this.$store.state.base_url+"/lingxis/blog/addManyPhoto",i={token:this.token,title:this.title,content:this.content,author:this.username,share_flag:this.form.radio};r.a.post(n,l.a.stringify(i)).then(function(n){var i=n.data;console.log(i);var s=i.code;if(402===s)return console.log("token 过期"),Object(a.a)(e.username,e.token),e.token=Object(o.b)("lingxi-token"),void e.selectFile();if(200===s){var c=i.id;console.log(s);var m=e.$store.state.base_url+"/lingxis/blog/editAddPhoto/"+c,d="";console.log(e.form.images1.length);for(var u=0;u<e.form.images1.length;u++)if((d=d+e.form.images1[u].image+"helloworld").length>10485760){var f={token:e.token,image:d};r.a.post(m,l.a.stringify(f)).then(function(t){var n=t.data;console.log(n);var i=n.code;402===i?(Object(a.a)(e.username,e.token),e.token=Object(o.b)("lingxi-token")):200===i?console.log(i):e.$message.error(i)}),d=""}if(d){var g={token:e.token,image:d};r.a.post(m,l.a.stringify(g)).then(function(t){var n=t.data.code;402===n?(Object(a.a)(e.username,e.token),e.token=Object(o.b)("lingxi-token")):200===n?console.log(n):e.$message.error(n)})}t.close(),e.$message.success("新建成功"),e.$router.push({path:"/main/home"}),e.$router.go(0)}else t.close(),e.$message.error("内部错误")})}}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("table",[n("tr",[e._m(0),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],attrs:{id:"title",name:"title",size:"30",type:"text"},domProps:{value:e.title},on:{input:function(t){t.target.composing||(e.title=t.target.value)}}})])]),e._v(" "),n("tr",[e._m(1),n("td",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"content"}],attrs:{cols:"40",id:"content",name:"content",rows:"20"},domProps:{value:e.content},on:{input:function(t){t.target.composing||(e.content=t.target.value)}}})])]),e._v(" "),n("tr",[e._m(2),e._v(" "),n("td",[n("el-radio",{staticStyle:{"margin-left":"10px"},attrs:{label:1},model:{value:e.form.radio,callback:function(t){e.$set(e.form,"radio",t)},expression:"form.radio"}},[e._v("公开")]),e._v(" "),n("el-radio",{attrs:{label:0},model:{value:e.form.radio,callback:function(t){e.$set(e.form,"radio",t)},expression:"form.radio"}},[e._v("不公开")])],1)]),e._v(" "),n("br"),e._v(" "),n("tr",[e._m(3),e._v(" "),n("td",[n("span",{attrs:{align:"left"}},[n("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.openFile()}}},[e._v("选择文件")]),e._v(" "),n("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"filename",multiple:"multiple"},on:{change:e.showRealPath}})],1),e._v(" "),n("br"),e._v(" "),e._l(e.form.images1,function(t,o){return n("span",{key:o},[n("div",{staticClass:"img-box"},[n("img",{staticClass:"myimage",attrs:{src:t.image,alt:""}}),e._v(" "),n("div",{staticClass:"del-icon",on:{click:function(t){return e.deletePrePhoto(o)}}})])])})],2)]),e._v(" "),n("tr",[e._m(4),e._v(" "),n("td",[n("br"),e._v(" "),n("el-button",{attrs:{type:"info"},on:{click:e.postCancel}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.selectFile}},[e._v("提 交")])],1)])]),e._v(" "),n("br"),n("br")])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"title"}},[this._v("标题:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"content"}},[this._v("内容:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"content"}},[this._v("是否公开:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"addOther"}},[this._v("添加图片")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"Post entry"}})])}]};var d=n("VU/8")(c,m,!1,function(e){n("1X4W")},null,null);t.default=d.exports}});