webpackJsonp([18],{Wgp9:function(e,t){},w5di:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),o=a("exGp"),i=a.n(o),l=a("g5nd"),s=a("miE6"),d=a("mtWM"),c=a.n(d),m=(a("mw3O"),a("BoEg")),u={inject:["reload"],data:function(){return{title:"",content:"",imageAddr:"",image:"",imageAddrs:[],delImageAddrs:[],defaultImg:'this.src="'+a("DBQu")+'"',dialogImageUrl:"",dialogVisible:!1,fileList:[],form:{images1:[],radio:0}}},mounted:function(){var e=this,t=this.$route.params.id,a=Object(l.b)("lingxi-token"),r=this.$store.state.base_url+"/lingxis/view/"+t+"?token="+a;c.a.get(r).then(function(t){var r=t.data,n=r.code;if(console.log(n),402===n){var o=Object(l.b)("username");Object(s.a)(o,a),e.reload()}else if(200===n){e.title=r.data.title,e.content=r.data.content,e.form.radio=r.data.share_flag;var i=r.data.imageAddr,d=r.data.imageAddr.split("helloworld");if(-1!==i.indexOf("helloworld")){for(var c=0;c<d.length;c++)e.imageAddrs.push(d[c]);e.imageAddrs.pop()}else e.imageAddr=r.data.imageAddr}else console.log(n),e.$message.error("无acs权限！")})},methods:{deleteCurPhoto:function(e){this.delImageAddrs.push(this.imageAddrs[e]),this.imageAddrs.splice(e,1)},deletePrePhoto:function(e){this.form.images1.splice(e,1)},openFile:function(){document.getElementById("filename").click()},showRealPath:function(){for(var e=this,t=document.getElementById("filename").files,a=function(a){var r=t[a].name,n=new FileReader;n.readAsDataURL(t[a]),n.onload=function(){var t=n.result;e.form.images1.push({name:r,image:t})}},r=0;r<t.length;r++)a(r)},postCancel:function(){this.$router.push({path:"/main/home"})},postEntry:function(){var e=this;return i()(n.a.mark(function t(){var a,r,o,i,d,c,u,g,f,h,v,p,_,b,x;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(a=e.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),console.log("hello123"),r=Object(l.b)("lingxi-token"),o=e.$route.params.id,i=e.$store.state.base_url+"/lingxis/blog/edit/"+o,d=e.$store.state.base_url+"/lingxis/blog/editAddPhoto/"+o,c="",u=0;u<e.imageAddrs.length;u++)c=c+e.imageAddrs[u]+"helloworld";for(g="",f=0;f<e.delImageAddrs.length;f++)g=g+e.delImageAddrs[f]+"helloworld";return h={token:r,title:e.title,content:e.content,share_flag:e.form.radio,curImageAddrs:c,delImageAddrs:g},console.log("url: "+i),t.next=14,m.a.post(i,h);case 14:if(v=t.sent,console.log("aaaa"),402!==v.code){t.next=20;break}return Object(s.a)(e.username,r),e.postEntry(),t.abrupt("return");case 20:p="",_=0;case 22:if(!(_<e.form.images1.length)){t.next=35;break}if(!((p=p+e.form.images1[_].image+"helloworld").length>5242880)){t.next=32;break}return console.log(_),b={token:r,image:p},console.log(b),t.next=30,m.a.post(d,b);case 30:v=t.sent,p="";case 32:_++,t.next=22;break;case 35:if(!p){t.next=40;break}return x={token:r,image:p},console.log(x),t.next=40,m.a.post(d,x);case 40:a.close(),e.$router.push({path:"/main/detail/"+o}),e.reload();case 43:case"end":return t.stop()}},t,e)}))()}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("table",[a("tr",[e._m(0),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],attrs:{id:"title",name:"title",size:"30",type:"text"},domProps:{value:e.title},on:{input:function(t){t.target.composing||(e.title=t.target.value)}}})])]),e._v(" "),a("tr",[e._m(1),a("td",[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"content"}],attrs:{cols:"80",id:"content",name:"content",rows:"10"},domProps:{value:e.content},on:{input:function(t){t.target.composing||(e.content=t.target.value)}}})])]),e._v(" "),a("tr",[e._m(2),a("td",[e.imageAddr?a("div",[a("div",{staticClass:"img-box"},[a("img",{staticClass:"myimage",attrs:{src:e.imageAddr,alt:"logo",onerror:e.defaultImg}}),e._v(" "),a("div",{staticClass:"del-icon",on:{click:function(t){return e.deleteCurPhoto(e.index)}}})])]):a("div",e._l(e.imageAddrs,function(t,r){return a("span",{key:r},[a("div",{staticClass:"img-box"},[a("img",{staticClass:"myimage",attrs:{src:t,alt:"",onerror:e.defaultImg}}),e._v(" "),a("div",{staticClass:"del-icon",on:{click:function(t){return e.deleteCurPhoto(r)}}})])])}),0)])]),e._v(" "),a("tr",[e._m(3),e._v(" "),a("td",[a("el-radio",{staticStyle:{"margin-left":"10px"},attrs:{label:1},model:{value:e.form.radio,callback:function(t){e.$set(e.form,"radio",t)},expression:"form.radio"}},[e._v("公开")]),e._v(" "),a("el-radio",{attrs:{label:0},model:{value:e.form.radio,callback:function(t){e.$set(e.form,"radio",t)},expression:"form.radio"}},[e._v("不公开")])],1)]),e._v(" "),a("br"),e._v(" "),a("tr",[e._m(4),e._v(" "),a("td",[a("span",{attrs:{align:"left"}},[a("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.openFile()}}},[e._v("选择文件")]),e._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"filename",multiple:"multiple"},on:{change:e.showRealPath}})],1),e._v(" "),a("br"),e._v(" "),e._l(e.form.images1,function(t,r){return a("span",{key:r},[a("div",{staticClass:"img-box"},[a("img",{staticClass:"myimage",attrs:{src:t.image,alt:""}}),e._v(" "),a("div",{staticClass:"del-icon",on:{click:function(t){return e.deletePrePhoto(r)}}})])])})],2)]),e._v(" "),a("tr",[e._m(5),e._v(" "),a("td",[a("br"),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.postCancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.postEntry}},[e._v("提 交")])],1)])]),e._v(" "),a("br"),a("br")])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"title"}},[this._v("标题:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"content"}},[this._v("内容:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"content"}},[this._v("当前图片:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"content"}},[this._v("是否公开:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"addOther"}},[this._v("添加图片")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"Post entry"}})])}]};var f=a("VU/8")(u,g,!1,function(e){a("Wgp9")},null,null);t.default=f.exports}});