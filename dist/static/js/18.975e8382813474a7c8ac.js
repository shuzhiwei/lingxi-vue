webpackJsonp([18],{"0kIm":function(t,e){},coli:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("BO1k"),s=a.n(n),i=a("mtWM"),o=a.n(i),r=a("mw3O"),l=a.n(r),c=a("g5nd"),u=a("miE6"),v=(a("x9pK"),{inject:["reload"],data:function(){return{datas:[],token:Object(c.b)("lingxi-token"),id:"",p_type:"",v0:"",v1:"",v2:"",v3:"",tableDataAmount:[],pageSize:200,pageNo:1,totalPage:0,paginationShow:!1,totalCount:0}},mounted:function(){var t=this,e=this.token,a=this.$store.state.base_url+"/acs-manage/policy/show";console.log(a);var n={token:e,pageSize:this.pageSize,pageNo:this.pageNo};o.a.post(a,l.a.stringify(n)).then(function(a){var n=a.data;console.log(n);var s=n.code;if(402===s){var i=Object(c.b)("username");return Object(u.a)(i,e),void t.reload()}if(401!==s){t.totalPage=n.totalPage,t.totalCount=n.totalCount;for(var o=n.data,r=0;r<o.length;r++){var l={id:o[r].id,p_type:o[r].p_type,v0:o[r].v0,v1:o[r].v1,v2:o[r].v2,v3:o[r].v3,statusBtn:!1};t.datas.push(l)}t.totalPage>1&&(t.paginationShow=!0)}else t.$message.error("无acs权限！")}).catch(function(e){console.log(e),t.$message.error(e)})},methods:{handleSizeChange:function(t){var e=this;this.$nextTick(function(){return e.getPageData()})},handleCurrentChange:function(t){this.getPageData()},getPageData:function(){var t=this,e=this.$store.state.base_url+"/acs-manage/policy/show",a={token:this.token,pageSize:this.pageSize,pageNo:this.pageNo};o.a.post(e,l.a.stringify(a)).then(function(e){var a=e.data,n=a.code;if(console.log(n),402===n){var s=Object(c.b)("username");return Object(u.a)(s,token),void t.reload()}if(401!==n){var i=a.data;t.datas=[];for(var o=0;o<i.length;o++){var r={id:i[o].id,p_type:i[o].p_type,v0:i[o].v0,v1:i[o].v1,v2:i[o].v2,v3:i[o].v3,statusBtn:!1};t.datas.push(r)}}else t.$message.error("无acs权限！")}).catch(function(e){console.log(e),t.$message.error(e)})},handleSelectionChange:function(t){this.tableDataAmount=t},delRows:function(){var t=this;if(!0===confirm("确定删除吗？")){var e=this.tableDataAmount;if(e){for(var a="",n=0;n<e.length;n++)a=a+e[n].id+",";console.log("ids: "+a);var s=this.$store.state.base_url+"/acs-manage/policy/delete",i={token:this.token,ids:a};o.a.post(s,l.a.stringify(i)).then(function(e){200===e.data.code?t.$message.success("删除成功"):(t.$message,error(e.data.code))}).catch(function(t){console.log(t)}),this.reload()}}else this.$message.success("已取消删除")},cancelRow:function(){this.reload()},filterHandler:function(t,e,a){return e[a.property]===t},flagFun:function(){return this.datas.every(function(t){return""!==t.p_type&&""!==t.v0&&""!==t.v1})},addRow:function(){if(0===this.datas.length)this.datas.unshift({p_type:"",v0:"",v1:"",v2:"",v3:"",statusBtn:!0});else{var t=!0,e=!1,a=void 0;try{for(var n,i=s()(this.datas);!(t=(n=i.next()).done);t=!0){if(n.value.statusBtn)return this.$message.warning("请先保存当前编辑项")}}catch(t){e=!0,a=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw a}}this.flagFun()?this.datas.unshift({p_type:"",v0:"",v1:"",v2:"",v3:"",statusBtn:!0}):this.$message({message:"p_type和v0不能为空",type:"warning"})}},editCheck:function(t){var e=!0,a=!1,n=void 0;try{for(var i,o=s()(this.datas);!(e=(i=o.next()).done);e=!0){var r=i.value;if(r.statusBtn&&r.id!=t.id)return this.$message.warning("请先保存当前编辑项"),!1}}catch(t){a=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw n}}t.statusBtn=!0,this.id=t.id,this.p_type=t.p_type,this.v0=t.v0,this.v1=t.v1,this.v2=t.v2,this.v3=t.v3},sureCheck:function(){var t=this;if(console.log(this.p_type+","+this.v0),""===this.id)if(""!==this.p_type&&""!==this.v0&&""!==this.v1){var e=this.$store.state.base_url+"/acs-manage/policy/add",a={token:this.token,p_type:this.p_type,v0:this.v0,v1:this.v1,v2:this.v2,v3:this.v3};o.a.post(e,l.a.stringify(a)).then(function(e){200===e.data.code?(t.$message.success("保存成功"),t.id="",t.reload()):t.$message.error(e.data.code)}).catch(function(t){console.log(t)})}else this.$message.error("请补全数据");else if(""!==this.p_type&&""!==this.v0&&""!==this.v1){var n=this.$store.state.base_url+"/acs-manage/policy/update",s={token:this.token,id:this.id,p_type:this.p_type,v0:this.v0,v1:this.v1,v2:this.v2,v3:this.v3};o.a.post(n,l.a.stringify(s)).then(function(e){200===e.data.code?(t.$message.success("保存成功"),t.id="",t.reload()):(t.$message,error(e.data.code))}).catch(function(t){console.log(t)})}},deleteFun:function(t){var e=this;if(t.row.id)if(!0===confirm("确定删除吗？"+t.row.p_type+", "+t.row.v0+", "+t.row.v1+", "+t.row.v2+", "+t.row.v3)){var a=this.$store.state.base_url+"/acs-manage/policy/delete",n={token:this.token,ids:t.row.id+","};o.a.post(a,l.a.stringify(n)).then(function(t){200===t.data.code?(e.$message.success("删除成功"),e.reload()):(e.$message,error(t.data.code))}).catch(function(t){console.log(t)})}else this.$message.success("已取消删除");else this.$message.error("id为空"),this.tableData.splice(t.$index,1)},addAuth:function(){this.$router.push({path:"/main/addAuth"})},deleteAuth:function(){var t=this;if(!0===confirm("确定删除吗？")){for(var e=this.$refs.inputTitle,a="",n=0;n<e.length;n++)e[n].checked&&(a=a+e[n].value+",");if(a){var s=this.$store.state.base_url+"/acs-manage/policy/delete",i={token:this.token,ids:a};o.a.post(s,l.a.stringify(i)).then(function(e){var a=e.data;200===a.code?t.reload():t.$message.error(a.code)})}else this.$message.error("不能删除0条！")}}}}),d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("br"),t._v(" "),a("el-button",{staticStyle:{"margin-bottom":"10px","margin-left":"30px"},attrs:{type:"success",icon:"el-icon-plus",size:"mini"},on:{click:function(e){return t.addRow()}}}),t._v(" "),a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{icon:"el-icon-minus",size:"mini"},on:{click:function(e){return t.cancelRow()}}}),t._v(" "),a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{icon:"el-icon-delete",type:"danger",size:"mini"},on:{click:function(e){return t.delRows()}}}),t._v(" "),a("el-table",{ref:"filterTable",staticStyle:{width:"95%","font-size":"16px","margin-left":"30px"},attrs:{height:"500",border:"",data:t.datas},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),t._v(" "),a("el-table-column",{attrs:{prop:"p_type",label:"p_type",sortable:"","column-key":"p_type",filters:[{text:"p",value:"p"},{text:"g",value:"g"}],"filter-method":t.filterHandler},scopedSlots:t._u([{key:"default",fn:function(e){return[!1===e.row.statusBtn?a("span",[t._v(t._s(e.row.p_type))]):!0===e.row.statusBtn?a("el-input",{attrs:{size:"mini"},model:{value:t.p_type,callback:function(e){t.p_type=e},expression:"p_type"}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"v0",label:"v0",filters:[{text:"shuzhiwei",value:"shuzhiwei"},{text:"admin",value:"admin"},{text:"houtingyu",value:"houtingyu"},{text:"admin_role",value:"admin_role"},{text:"user_role",value:"user_role"},{text:"entertainment_role",value:"entertainment_role"},{text:"helloworld",value:"helloworld"},{text:"blog_role",value:"blog_role"}],"filter-method":t.filterHandler},scopedSlots:t._u([{key:"default",fn:function(e){return[!1===e.row.statusBtn?a("span",[t._v(t._s(e.row.v0))]):!0===e.row.statusBtn?a("el-input",{attrs:{size:"mini"},model:{value:t.v0,callback:function(e){t.v0=e},expression:"v0"}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"v1",label:"v1","column-key":"v1",filters:[{text:"acs",value:"acs"},{text:"blog",value:"blog"},{text:"rde",value:"rde"}],"filter-method":t.filterHandler},scopedSlots:t._u([{key:"default",fn:function(e){return[!1===e.row.statusBtn?a("span",[t._v(t._s(e.row.v1))]):!0===e.row.statusBtn?a("el-input",{attrs:{size:"mini"},model:{value:t.v1,callback:function(e){t.v1=e},expression:"v1"}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"v2",label:"v2"},scopedSlots:t._u([{key:"default",fn:function(e){return[!1===e.row.statusBtn?a("span",[t._v(t._s(e.row.v2))]):!0===e.row.statusBtn?a("el-input",{attrs:{size:"mini"},model:{value:t.v2,callback:function(e){t.v2=e},expression:"v2"}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"v3",label:"v3"},scopedSlots:t._u([{key:"default",fn:function(e){return[!1===e.row.statusBtn?a("span",[t._v(t._s(e.row.v3))]):!0===e.row.statusBtn?a("el-input",{attrs:{size:"mini"},model:{value:t.v3,callback:function(e){t.v3=e},expression:"v3"}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[!1===e.row.statusBtn?a("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-edit"},on:{click:function(a){return t.editCheck(e.row)}}},[t._v("编辑")]):!0===e.row.statusBtn?a("el-button",{staticStyle:{display:"inline-block"},attrs:{type:"success",size:"mini",icon:"el-icon-check"},on:{click:function(e){return t.sureCheck()}}},[t._v("保存")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(a){return t.deleteFun(e)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"block",staticStyle:{"text-align":"center"}},[t.paginationShow?a("el-pagination",{attrs:{"current-page":t.pageNo,"page-size":200,layout:"total, prev, pager, next, jumper","font-size":"30px",total:t.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.pageNo=e},"update:current-page":function(e){t.pageNo=e}}}):t._e()],1)])},staticRenderFns:[]};var p=a("VU/8")(v,d,!1,function(t){a("0kIm")},null,null);e.default=p.exports}});