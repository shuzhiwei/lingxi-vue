webpackJsonp([20],{tfHa:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Xxa5"),r=n.n(a),o=n("exGp"),i=n.n(o),s=n("g5nd"),l=n("miE6"),c=(n("mtWM"),n("mw3O"),n("BoEg")),u={inject:["reload"],data:function(){return{token:Object(s.b)("lingxi-token"),username:Object(s.b)("username"),title:"",content:"",imageAddr:"",image:"",imageAddrs:[],delImageAddrs:[],defaultImg:'this.src="'+n("DBQu")+'"',dialogImageUrl:"",dialogVisible:!1,fileList:[],form:{images1:[],radio:0}}},methods:{deleteCurPhoto:function(e){this.delImageAddrs.push(this.imageAddrs[e]),this.imageAddrs.splice(e,1)},deletePrePhoto:function(e){this.form.images1.splice(e,1)},openFile:function(){document.getElementById("filename").click()},showRealPath:function(){for(var e=this,t=document.getElementById("filename").files,n=function(n){var a=t[n].name,r=new FileReader;r.readAsDataURL(t[n]),r.onload=function(){var t=r.result;e.form.images1.push({name:a,image:t})}},a=0;a<t.length;a++)n(a)},postCancel:function(){this.$router.push({path:"/main/home"})},addManyPhoto:function(){var e=this;return i()(r.a.mark(function t(){var n,a,o,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object(s.b)("lingxi-token"),a=e.$store.state.base_url+"/lingxis/blog/addManyPhoto",o={token:n,title:e.title,content:e.content,author:e.username,share_flag:e.form.radio},t.next=5,c.a.post(a,o);case 5:if(i=t.sent,console.log(i),402!==i.code){t.next=12;break}return Object(l.a)(e.username,n),e.addManyPhoto(),t.abrupt("return");case 12:return t.abrupt("return",i.id);case 13:case"end":return t.stop()}},t,e)}))()},addManyPhoto1:function(e){var t=this;return i()(r.a.mark(function n(){var a,o,i,u,d,m,f;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a=Object(s.b)("lingxi-token"),o=t.$store.state.base_url+"/lingxis/blog/editAddPhoto/"+e,i="",console.log(t.form.images1.length),u=0;case 5:if(!(u<t.form.images1.length)){n.next=22;break}if(!((i=i+t.form.images1[u].image+"helloworld").length>5242880)){n.next=19;break}return d={token:a,image:i},n.next=11,c.a.post(o,d);case 11:if(m=n.sent,console.log(m),402!==m.code){n.next=18;break}return Object(l.a)(t.username,a),t.addManyPhoto1(e),n.abrupt("return");case 18:i="";case 19:u++,n.next=5;break;case 22:if(!i){n.next=32;break}return f={token:t.token,image:i},n.next=26,c.a.post(o,f);case 26:if(m=n.sent,402!==m.code){n.next=31;break}return Object(l.a)(t.username,a),n.abrupt("return");case 31:console.log(m);case 32:case"end":return n.stop()}},n,t)}))()},selectFile:function(){var e=this;return i()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t.next=3,e.addManyPhoto();case 3:return a=t.sent,t.next=6,e.addManyPhoto1(a);case 6:n.close(),e.$message.success("新建成功"),e.$router.push({path:"/main/home"}),e.$router.go(0);case 10:case"end":return t.stop()}},t,e)}))()}}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{align:"center"}},[n("table",{attrs:{align:"center"}},[n("tr",[e._m(0),n("td",[n("el-input",{attrs:{placeholder:"请输入标题",clearable:""},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}})],1)]),e._v(" "),n("tr",[e._m(1),n("td",[n("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:20},placeholder:"请输入内容"},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)]),e._v(" "),n("tr",[e._m(2),e._v(" "),n("td",[n("el-radio",{staticStyle:{"margin-left":"10px"},attrs:{label:1},model:{value:e.form.radio,callback:function(t){e.$set(e.form,"radio",t)},expression:"form.radio"}},[e._v("公开")]),e._v(" "),n("el-radio",{attrs:{label:0},model:{value:e.form.radio,callback:function(t){e.$set(e.form,"radio",t)},expression:"form.radio"}},[e._v("不公开")])],1)]),e._v(" "),n("br"),e._v(" "),n("tr",[e._m(3),e._v(" "),n("td",[n("span",{attrs:{align:"left"}},[n("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.openFile()}}},[e._v("选择文件")]),e._v(" "),n("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"filename",multiple:"multiple"},on:{change:e.showRealPath}})],1),e._v(" "),n("br"),e._v(" "),e._l(e.form.images1,function(t,a){return n("span",{key:a},[n("div",{staticClass:"img-box"},[n("img",{staticClass:"myimage",attrs:{src:t.image,alt:""}}),e._v(" "),n("div",{staticClass:"del-icon",on:{click:function(t){return e.deletePrePhoto(a)}}})])])})],2)]),e._v(" "),n("tr",[e._m(4),e._v(" "),n("td",[n("br"),e._v(" "),n("el-button",{attrs:{type:"info"},on:{click:e.postCancel}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.selectFile}},[e._v("提 交")])],1)])]),e._v(" "),n("br"),n("br")])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"title"}},[this._v("标题：")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"content"}},[this._v("内容：")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"content"}},[this._v("分享：")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"addOther"}},[this._v("图片：")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"Post entry"}})])}]};var m=n("VU/8")(u,d,!1,function(e){n("zxj/")},null,null);t.default=m.exports},"zxj/":function(e,t){}});